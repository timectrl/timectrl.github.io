# Generated by Anaconda 34.24.9
# Generated by pykickstart v3.32
#version=DEVEL
# Use graphical install
graphical

# Keyboard layouts
keyboard --xlayouts='us'
# System language
lang en_US.UTF-8

# Use network installation
url --url="https://repo.huaweicloud.com/fedora/releases/34/Everything/x86_64/os"

#%packages
#@^workstation-product-environment

#%end

# SELinux configuration
selinux --disabled

# Run the Setup Agent on first boot
firstboot --enable
# Do not configure the X Window System
skipx

# Generated using Blivet version 3.3.3
#ignoredisk --only-use=vda
# Partition clearing information
#clearpart --all --drives=vda
# Disk partitioning information
#part /boot/efi --fstype="efi" --ondisk=vda --size=128   --fsoptions="umask=0077,shortname=winnt"
#part /         --fstype="xfs" --ondisk=vda --size=10240 --grow

# System timezone
timezone Asia/Shanghai

#Root password
rootpw --lock
user --groups=wheel --name=zhangquan --password=$6$knMxMxQswPp4m0ey$d2a5bx0jdg.xyLNZq8umq8jkiMBmVVmS.13wljTeUdmM9U7JXtW/MEjUrMFnRwmJ8Z2q36WrNMU2m4ZgI8/7z1 --iscrypted --gecos="ZhangQuan"



#%post --log=/root/init.log
%post
dnf -y install wget

mkdir -p /root/.ssh
wget -O /root/.ssh/authorized_keys http://www.timectrl.net/files/authorized_keys
chmod 700 /root/.ssh
chmod 600 /root/.ssh/authorized_keys
passwd -l root

mkdir -p /home/zhangquan/.ssh
wget -O /home/zhangquan/.ssh/authorized_keys http://www.timectrl.net/files/authorized_keys
chmod 700 /home/zhangquan/.ssh
chmod 600 /home/zhangquan/.ssh/authorized_keys
#passwd -l zhangquan
echo 'zhangquan ALL=(ALL) NOPASSWD: ALL' > /etc/sudoers.d/zhangquan-root


#dnf -y install http://static.jikedata.com/rpm/proton.rpm

#rm -fr /root/original-ks.cfg /root/anaconda-ks.cfg /root/init.log
%end



reboot

